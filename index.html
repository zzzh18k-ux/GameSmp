<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Task Hub ULTIMATE</title>
    
    <script src='//libtl.com/sdk.js' data-zone='10278425' data-sdk='show_10278425'></script>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* TEMA NEÃ“N FUTURE */
        :root { --bg: #050505; --card: #111; --primary: #00ffcc; --secondary: #d500f9; --text: #fff; }
        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent; }
        body { 
            background-color: var(--bg); color: var(--text); font-family: 'Rajdhani', sans-serif; 
            min-height: 100vh; display: flex; flex-direction: column; align-items: center; 
            background-image: linear-gradient(180deg, #0a0a12 0%, #000 100%);
            padding: 15px; padding-bottom: 50px;
        }

        #banScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 99999; 
            display: none; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 30px;
        }
        .ban-icon { font-size: 60px; color: #ff3333; margin-bottom: 20px; }

        .app-container { width: 100%; max-width: 450px; display: flex; flex-direction: column; gap: 15px; }

        /* BARRA DE PROGRESO */
        .progress-box {
            background: var(--card); border: 1px solid #333; border-radius: 20px; padding: 15px;
            box-shadow: 0 0 20px rgba(0, 255, 204, 0.1); text-align: center;
        }
        .prog-track { width: 100%; height: 20px; background: #222; border-radius: 10px; overflow: hidden; margin: 10px 0; border: 1px solid #444; }
        .prog-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--primary), var(--secondary)); transition: 0.5s; }
        .prog-text { display: flex; justify-content: space-between; font-size: 14px; font-weight: bold; color: var(--primary); }

        /* RULETA PEQUEÃ‘A */
        .wheel-section {
            background: #151515; border-radius: 20px; padding: 15px; border: 1px solid var(--secondary);
            display: flex; flex-direction: column; align-items: center; position: relative; overflow: hidden;
        }
        .wheel-title { color: var(--secondary); font-weight: 900; letter-spacing: 2px; margin-bottom: 10px; font-size: 18px; }
        
        .wheel-container { position: relative; width: 200px; height: 200px; } /* TamaÃ±o mini */
        .wheel { width: 100%; height: 100%; border-radius: 50%; border: 3px solid var(--text); background: conic-gradient(
            #222 0deg 45deg, #333 45deg 90deg, #222 90deg 135deg, #333 135deg 180deg,
            #222 180deg 225deg, #333 225deg 270deg, #222 270deg 315deg, #333 315deg 360deg
        ); transition: transform 3s cubic-bezier(0.2, 0.8, 0.2, 1); position: relative; }
        
        .pointer { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 20px; height: 30px; background: var(--secondary); clip-path: polygon(50% 100%, 0 0, 100% 0); z-index: 10; }
        
        .btn-spin { 
            margin-top: 15px; background: var(--secondary); color: white; border: none; padding: 10px 25px; 
            border-radius: 20px; font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 8px;
            box-shadow: 0 0 15px rgba(213, 0, 249, 0.3); animation: pulse 2s infinite;
        }

        /* LISTA DE 7 BOTONES */
        .tasks-list { display: flex; flex-direction: column; gap: 10px; width: 100%; }
        
        .task-btn {
            width: 100%; padding: 14px; border-radius: 12px; border: 1px solid #222;
            background: #111; color: white; cursor: pointer; position: relative;
            display: flex; justify-content: space-between; align-items: center;
            transition: 0.2s;
        }
        .task-btn:active { transform: scale(0.98); background: #222; }
        
        .type-adsgram { border-left: 3px solid var(--primary); }
        .type-monetag { border-left: 3px solid var(--secondary); }
        
        .btn-left { display: flex; align-items: center; gap: 12px; }
        .btn-icon { font-size: 18px; width: 25px; text-align: center; }
        .type-adsgram .btn-icon { color: var(--primary); }
        .type-monetag .btn-icon { color: var(--secondary); }
        
        .btn-info { text-align: left; }
        .btn-title { font-weight: bold; font-size: 15px; }
        .btn-sub { font-size: 11px; color: #666; margin-top: 2px; }
        .btn-reward { font-size: 12px; font-weight: bold; color: #888; background: #000; padding: 5px 8px; border-radius: 6px; }

        .task-btn:disabled { opacity: 0.5; cursor: not-allowed; background: #080808; border-color: #111; }
        .timer-text { color: var(--secondary); font-size: 11px; font-weight: bold; }

        /* FOOTER */
        .btn-withdraw { 
            width: 100%; padding: 18px; border-radius: 15px; font-weight: 900; border: none; margin-top: 10px;
            cursor: pointer; background: linear-gradient(90deg, var(--primary), #0099ff); 
            color: #000; font-size: 16px; text-transform: uppercase; 
        }
        .mini-links { display: flex; gap: 10px; margin-top: 5px; }
        .link-btn { flex: 1; background: #151515; border: 1px solid #333; color: #aaa; padding: 10px; border-radius: 8px; cursor: pointer; font-size: 12px; }

        /* MODAL */
        #receiptModal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); display:none; justify-content:center; align-items:center; flex-direction:column; z-index:100; padding: 30px; }
        .modal-box { background: #151515; padding: 30px; border-radius: 20px; border: 1px solid var(--primary); width: 100%; text-align: center; }
        .receipt-row { display: flex; justify-content: space-between; border-bottom: 1px dashed #444; padding: 10px 0; font-size: 13px; color: #ccc; }
        .receipt-val { color: var(--primary); font-weight: bold; }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div id="banScreen">
        <i class="fa-solid fa-ban ban-icon"></i>
        <h2 style="color:white; margin-bottom:10px;">ACCESO DENEGADO</h2>
        <p style="color:#888;">Multicuenta detectada.</p>
    </div>

    <div class="app-container" id="appContent">
        
        <div class="progress-box">
            <div style="font-size:12px; color:#888; letter-spacing:1px; margin-bottom:5px;">META DE RETIRO</div>
            <div style="font-size:35px; font-weight:900; color:#fff;"><span id="saldo">0</span> Pts</div>
            
            <div class="prog-track"><div class="prog-fill" id="progBar"></div></div>
            <div class="prog-text">
                <span>0%</span>
                <span style="color:#fff;">META: 2,500 Pts ($0.10)</span>
                <span>100%</span>
            </div>
        </div>

        <div class="wheel-section">
            <div class="wheel-title">RULETA INFINITA</div>
            <div class="wheel-container">
                <div class="pointer"></div>
                <div class="wheel" id="wheel"></div>
            </div>
            <button class="btn-spin" onclick="spinWheel()">
                <i class="fa-solid fa-video"></i> VER VIDEO & GIRAR
            </button>
            <div style="font-size:10px; color:#666; margin-top:8px;">Gana 1 a 5 Puntos por giro</div>
        </div>

        <div class="tasks-list">
            <div style="color:#666; font-size:12px; margin-left:5px; font-weight:bold;">MISIONES DIARIAS (Puntos Aleatorios)</div>

            <button class="task-btn type-adsgram" id="btn1" onclick="watchTask(1, 'adsgram')">
                <div class="btn-left"><i class="fa-solid fa-play btn-icon"></i>
                    <div class="btn-info"><div class="btn-title">Ads #1</div><div class="btn-sub" id="t1">Disponible</div></div>
                </div><div class="btn-reward">??? Pts</div>
            </button>

            <button class="task-btn type-monetag" id="btn2" onclick="watchTask(2, 'monetag')">
                <div class="btn-left"><i class="fa-solid fa-circle-play btn-icon"></i>
                    <div class="btn-info"><div class="btn-title">Ads #2</div><div class="btn-sub" id="t2">Disponible</div></div>
                </div><div class="btn-reward">??? Pts</div>
            </button>

            <button class="task-btn type-adsgram" id="btn3" onclick="watchTask(3, 'adsgram')">
                <div class="btn-left"><i class="fa-solid fa-play btn-icon"></i>
                    <div class="btn-info"><div class="btn-title">Ads #3</div><div class="btn-sub" id="t3">Disponible</div></div>
                </div><div class="btn-reward">??? Pts</div>
            </button>

            <button class="task-btn type-monetag" id="btn4" onclick="watchTask(4, 'monetag')">
                <div class="btn-left"><i class="fa-solid fa-circle-play btn-icon"></i>
                    <div class="btn-info"><div class="btn-title">Ads #4</div><div class="btn-sub" id="t4">Disponible</div></div>
                </div><div class="btn-reward">??? Pts</div>
            </button>

            <button class="task-btn type-adsgram" id="btn5" onclick="watchTask(5, 'adsgram')">
                <div class="btn-left"><i class="fa-solid fa-play btn-icon"></i>
                    <div class="btn-info"><div class="btn-title">Ads #5</div><div class="btn-sub" id="t5">Disponible</div></div>
                </div><div class="btn-reward">??? Pts</div>
            </button>

            <button class="task-btn type-monetag" id="btn6" onclick="watchTask(6, 'monetag')">
                <div class="btn-left"><i class="fa-solid fa-circle-play btn-icon"></i>
                    <div class="btn-info"><div class="btn-title">Ads #6</div><div class="btn-sub" id="t6">Disponible</div></div>
                </div><div class="btn-reward">??? Pts</div>
            </button>

            <button class="task-btn type-adsgram" id="btn7" onclick="watchTask(7, 'adsgram')">
                <div class="btn-left"><i class="fa-solid fa-play btn-icon"></i>
                    <div class="btn-info"><div class="btn-title">Ads #7</div><div class="btn-sub" id="t7">Disponible</div></div>
                </div><div class="btn-reward">??? Pts</div>
            </button>
        </div>

        <button class="btn-withdraw" onclick="retirar()">
            <i class="fa-solid fa-money-bill-transfer"></i> SOLICITAR PAGO ($0.10)
        </button>

        <div class="mini-links">
            <button class="link-btn" onclick="tg.openTelegramLink('https://t.me/AtencionYougamefavoriteBot')">Soporte</button>
            <button class="link-btn" onclick="tg.openTelegramLink('https://t.me/noticebuddy')">Canal Oficial</button>
        </div>
    </div>

    <div id="receiptModal">
        <div class="modal-box">
            <h2 style="color:var(--primary); margin-bottom:15px;">âœ… SOLICITUD CREADA</h2>
            <div class="receipt-row"><span>USUARIO:</span><span class="receipt-val" id="recUser">...</span></div>
            <div class="receipt-row"><span>FECHA:</span><span class="receipt-val" id="recDate">...</span></div>
            <div class="receipt-row"><span>HORA:</span><span class="receipt-val" id="recTime">...</span></div>
            <div class="receipt-row"><span>MONTO:</span><span class="receipt-val">$0.10 USD</span></div>
            <button style="background:var(--primary); color:#000; width:100%; padding:15px; border-radius:10px; margin-top:20px; font-weight:bold;" onclick="tg.openTelegramLink('https://t.me/AtencionYougamefavoriteBot')">ðŸ“© ENVIAR CAPTURA</button>
            <button style="background:transparent; border:none; color:#666; margin-top:10px;" onclick="location.reload()">Cerrar</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp; tg.expand();
        tg.setHeaderColor('#050505'); tg.setBackgroundColor('#050505');

        const ADSGRAM_ID = "18841"; 
        const MEMORY_KEY = 'hybrid_hub_v84';
        const META = 2500;
        const COOLDOWN = 24 * 60 * 60 * 1000; // 24H

        let user = { balance: 0, timers: {} };
        for(let i=1; i<=7; i++) { if(!user.timers[i]) user.timers[i] = 0; }
        let isSpinning = false;

        // --- INIT ---
        window.onload = function() {
            // Anti-Multi
            const cid = tg.initDataUnsafe?.user?.id || 12345; 
            const sid = localStorage.getItem('did');
            if (sid && sid != cid) {
                document.getElementById('appContent').style.display = 'none';
                document.getElementById('banScreen').style.display = 'flex';
                return;
            } 
            if (!sid) localStorage.setItem('did', cid);

            if(localStorage.getItem(MEMORY_KEY)) { 
                let saved = JSON.parse(localStorage.getItem(MEMORY_KEY));
                user.balance = parseInt(saved.balance) || 0;
                user.timers = saved.timers || user.timers;
            }
            updateUI();
            setInterval(checkTimers, 1000);
        };

        function updateUI() { 
            document.getElementById('saldo').innerText = user.balance;
            let pct = (user.balance / META) * 100;
            if(pct > 100) pct = 100;
            document.getElementById('progBar').style.width = pct + "%";
            checkTimers(); 
        }
        function save() { localStorage.setItem(MEMORY_KEY, JSON.stringify(user)); updateUI(); }

        function checkTimers() {
            const now = Date.now();
            for(let i=1; i<=7; i++) {
                const btn = document.getElementById('btn'+i);
                const txt = document.getElementById('t'+i);
                if(now < user.timers[i]) {
                    const h = Math.floor((user.timers[i] - now) / 3600000);
                    const m = Math.floor(((user.timers[i] - now) % 3600000) / 60000);
                    btn.disabled = true;
                    txt.innerText = `Espera ${h}h ${m}m`;
                    txt.classList.add('timer-text');
                } else {
                    btn.disabled = false;
                    txt.innerText = "Disponible";
                    txt.classList.remove('timer-text');
                }
            }
        }

        // --- LÃ“GICA DE BOTONES (3 a 12 Puntos) ---
        function watchTask(id, provider) {
            const btn = document.getElementById('btn'+id);
            if(btn.disabled) return;
            
            btn.style.opacity = "0.5";
            if(provider === 'adsgram') {
                const AdController = window.Adsgram.init({ blockId: ADSGRAM_ID });
                AdController.show().then(()=>{ payTask(id); }).catch(()=>{ tryMonetagTask(id); });
            } else {
                tryMonetagTask(id);
            }
        }

        function tryMonetagTask(id) {
            if (typeof show_10278425 === 'function') {
                show_10278425().then(()=>{ payTask(id); }).catch(()=>{ error(); });
            } else { error(); }
        }

        function payTask(id) {
            const btn = document.getElementById('btn'+id);
            btn.style.opacity = "1";
            // Random Reward: 3 a 12 puntos
            let pts = Math.floor(Math.random() * (12 - 3 + 1)) + 3;
            user.balance += pts;
            user.timers[id] = Date.now() + COOLDOWN;
            save();
            tg.showPopup({ title:"Â¡Completado!", message:`+${pts} Puntos` });
        }

        // --- LÃ“GICA DE RULETA INFINITA (1 a 5 Puntos) ---
        function spinWheel() {
            if(isSpinning) return;
            
            // PRIMERO VE EL VIDEO
            const AdController = window.Adsgram.init({ blockId: ADSGRAM_ID });
            AdController.show().then(()=>{ 
                doSpin(); // Si ve el video, gira
            }).catch(()=>{ 
                // Fallback a Monetag
                if (typeof show_10278425 === 'function') {
                    show_10278425().then(()=>{ doSpin(); }).catch(()=>{ error(); });
                } else { error(); }
            });
        }

        function doSpin() {
            isSpinning = true;
            let wheel = document.getElementById('wheel');
            let deg = Math.floor(5000 + Math.random() * 5000); // Giro fuerte
            wheel.style.transform = `rotate(${deg}deg)`;
            
            setTimeout(() => {
                isSpinning = false;
                // Reward bajito para la ruleta (1 a 5 pts)
                let pts = Math.floor(Math.random() * 5) + 1;
                user.balance += pts;
                save();
                tg.showPopup({ title:"Â¡Ruleta!", message:`+${pts} Puntos` });
                wheel.style.transition = 'none';
                wheel.style.transform = `rotate(${deg % 360}deg)`;
                setTimeout(()=>{ wheel.style.transition = 'transform 3s cubic-bezier(0.2, 0.8, 0.2, 1)'; }, 50);
            }, 3000);
        }

        function error() { tg.showAlert("Video no disponible. Intenta mÃ¡s tarde."); }

        function retirar() {
            if(user.balance < META) { tg.showAlert(`Faltan ${META - user.balance} Puntos.`); return; }
            tg.showConfirm("Â¿Retirar $0.10?", (ok)=>{
                if(ok) {
                    user.balance -= META; save();
                    let d = new Date();
                    document.getElementById('recDate').innerText = d.toLocaleDateString();
                    document.getElementById('recTime').innerText = d.toLocaleTimeString();
                    document.getElementById('recUser').innerText = tg.initDataUnsafe?.user?.first_name || "User";
                    document.getElementById('receiptModal').style.display = 'flex';
                }
            });
        }
    </script>
</body>
            </html>
