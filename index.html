
    </d<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gold Hunter VIP</title>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #0b0b0f;
            --card: #15151a;
            --gold: #FFD700;
            --gold-grad: linear-gradient(135deg, #FFD700 0%, #FDB931 100%);
            --purple-grad: linear-gradient(45deg, #8e44ad, #3498db);
            --green: #2ecc71;
            --text: #ffffff;
        }

        body {
            margin: 0; padding: 0; background: var(--bg); color: var(--text);
            font-family: 'Montserrat', sans-serif; overflow: hidden; user-select: none;
        }

        /* --- NOTIFICACIONES ELEGANTES (TOAST) --- */
        #toast-container {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            z-index: 9999; display: flex; flex-direction: column; gap: 10px; width: 90%; pointer-events: none;
        }
        .toast {
            background: rgba(20, 20, 25, 0.95); border-left: 4px solid var(--gold);
            color: white; padding: 15px; border-radius: 8px; font-size: 13px; font-weight: 600;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5); opacity: 0; transform: translateY(-20px);
            animation: slideIn 0.3s forwards; display: flex; align-items: center; gap: 10px;
        }
        @keyframes slideIn { to { opacity: 1; transform: translateY(0); } }
        @keyframes slideOut { to { opacity: 0; transform: translateY(-20px); } }

        /* --- INTERFAZ --- */
        #app-ui { padding: 20px; display: flex; flex-direction: column; height: 100vh; box-sizing: border-box; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .user-badge { background: #222; padding: 5px 15px; border-radius: 20px; border: 1px solid #333; font-size: 12px; display: flex; align-items: center; gap: 8px; }
        
        .balance-card {
            background: var(--card); border-radius: 20px; padding: 25px; text-align: center;
            border: 1px solid rgba(255, 215, 0, 0.15); box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            margin-bottom: 25px; position: relative; overflow: hidden;
        }
        .balance-val { font-size: 42px; font-weight: 900; background: var(--gold-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 10px 0; }
        
        .btn-main {
            width: 100%; border: none; padding: 16px; border-radius: 12px;
            font-size: 16px; font-weight: 800; color: white; background: var(--purple-grad);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3); cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-main:active { transform: scale(0.98); }

        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: auto; padding-bottom: 10px; }
        .menu-btn {
            background: #1a1a20; border: 1px solid #333; padding: 12px; border-radius: 12px;
            color: #ccc; font-size: 11px; font-weight: 700; cursor: pointer;
            display: flex; flex-direction: column; align-items: center; gap: 5px;
        }

        /* --- MODALES --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 200; display: none;
            justify-content: center; align-items: center; backdrop-filter: blur(8px);
        }
        .modal-box {
            background: #15151a; width: 85%; padding: 25px; border-radius: 20px;
            border: 1px solid var(--gold); text-align: center; position: relative;
        }
        input { width: 100%; padding: 14px; margin: 10px 0; background: #000; border: 1px solid #333; border-radius: 10px; color: white; box-sizing: border-box; }
        
        /* --- JUEGO --- */
        #game-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 100; display: none; }
        #canvas { width: 100%; height: 100%; display: block; }
        .hud { position: absolute; top: 20px; width: 100%; display: flex; justify-content: space-between; padding: 0 20px; box-sizing: border-box; pointer-events: none; }
        .hud-item { background: rgba(0,0,0,0.7); padding: 8px 12px; border-radius: 15px; font-weight: bold; border: 1px solid #444; }
    </style>
</head>
    <body>

    <div id="toast-container"></div>

    <div id="app-ui">
        <div class="header">
            <div class="user-badge">
                <i class="fas fa-user-astronaut" style="color:var(--gold)"></i>
                <span id="username">Cargando...</span>
            </div>
            <div style="font-size:11px; color:#666;">ID: <span id="userid">...</span></div>
        </div>

        <div class="balance-card">
            <div style="font-size:11px; color:var(--gold); letter-spacing:1px;">BILLETERA DE SOCIO</div>
            <div class="balance-val">$<span id="ui-usd">0.0000</span></div>
            <div style="font-size:12px; color:#777;">USDT (Polygon Network)</div>
        </div>

        <button class="btn-main" onclick="preGameAd()">
            <i class="fas fa-gamepad"></i> JUGAR Y GANAR
        </button>

        <div class="menu-grid">
            <button class="menu-btn" onclick="openModal('modalWithdraw')">
                <i class="fas fa-wallet" style="color:var(--green)"></i> RETIRAR
            </button>
            <button class="menu-btn" onclick="copyReferral()">
                <i class="fas fa-users" style="color:#3498db"></i> INVITAR
            </button>
            <button class="menu-btn" onclick="openModal('modalHistory')">
                <i class="fas fa-history" style="color:var(--gold)"></i> HISTORIAL
            </button>
            <button class="menu-btn" onclick="tg.openTelegramLink('https://t.me/noticebuddy')">
                <i class="fab fa-telegram-plane" style="color:#0088cc"></i> CANAL OFICIAL
            </button>
        </div>
        
        <div id="status-dot" style="text-align:center; font-size:10px; color:#333; margin-top:10px;">Conectando red segura...</div>
    </div>

    <div id="game-layer">
        <div class="hud">
            <div class="hud-item" style="color:var(--gold)"><i class="fas fa-coins"></i> <span id="score-val">0</span></div>
            <div class="hud-item" style="color:#e74c3c"><i class="fas fa-clock"></i> <span id="time-val">45</span></div>
        </div>
        <canvas id="canvas"></canvas>
    </div>

    <div id="modalWithdraw" class="modal-overlay">
        <div class="modal-box">
            <h3 style="color:var(--gold); margin:0 0 15px 0;">RETIRAR SALDO</h3>
            <p style="font-size:11px; color:#bbb;">MÃ­nimo: $2.00 | Red: USDT Polygon</p>
            <input type="number" id="w-amount" placeholder="Monto a retirar">
            <input type="text" id="w-wallet" placeholder="DirecciÃ³n de Billetera">
            <button class="btn-main" onclick="processWithdraw()">CONFIRMAR RETIRO</button>
            <button onclick="closeModals()" style="background:none; border:none; color:#777; margin-top:15px; cursor:pointer;">Cancelar</button>
        </div>
    </div>

    <div id="modalHistory" class="modal-overlay">
        <div class="modal-box">
            <h3 style="color:white; margin:0 0 15px 0;">TUS MOVIMIENTOS</h3>
            <div id="h-list" style="text-align:left; max-height:200px; overflow-y:auto; font-size:12px;"></div>
            <button onclick="closeModals()" style="background:none; border:none; color:#777; margin-top:15px; cursor:pointer;">Cerrar</button>
        </div>
    </div>
        <script>
        const tg = window.Telegram.WebApp; tg.expand();
        
        // --- CONFIGURACIÃ“N MAESTRA ---
        const BOT_TOKEN = "8575758761:AAHM8aRoDIee_iICu4zwSYBuHJcyy7CXH_s"; // Â¡TOKEN NUEVO Y FUNCIONAL!
        const CHAT_ID = "-1002118088046"; 
        const ADS_ID = "18897"; 
        const KEY = 'gold_hunter_luxury_v4';

        let user = { usd: 2.0000, history: [], gamesPlayed: 0 };

        // --- SISTEMA DE NOTIFICACIONES (TOAST) ---
        function showToast(msg, icon = 'fas fa-info-circle', color = 'var(--gold)') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.style.borderLeftColor = color;
            toast.innerHTML = `<i class="${icon}" style="color:${color}; font-size:16px;"></i> <span>${msg}</span>`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s forwards';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // --- SISTEMA DE RECOMPENSAS DINÃMICAS (EL CASINO) ---
        function calculatePrize(score) {
            // Factor base: Mientras mÃ¡s saldo tiene, mÃ¡s difÃ­cil es ganar mucho (ProtecciÃ³n contra quiebra)
            let difficulty = user.usd > 1.0 ? 2 : 1; 
            
            // Probabilidad de "Jackpot" (Premio Grande)
            let chance = Math.random() * 100;
            let multiplier = 0.0001; // Base baja

            if (chance < 5 && user.usd < 3.0) { 
                // 5% de probabilidad de premio GRANDE (si no tiene mucho saldo)
                multiplier = 0.0020; 
                showToast("Â¡GOLPE DE SUERTE! Bonus x20", "fas fa-star", "#e74c3c");
            } else if (chance < 30) {
                // 25% de probabilidad de premio MEDIO
                multiplier = 0.0005;
            } else {
                // 70% de probabilidad de premio NORMAL (Mantenimiento)
                multiplier = 0.0001;
            }

            return (score * multiplier);
        }

        // --- SISTEMA DE REFERIDOS ---
        function copyReferral() {
            const userId = tg.initDataUnsafe?.user?.id || "12345";
            const link = `https://t.me/YougamefavoriteBot?start=ref_${userId}`;
            const text = `ðŸš€ Â¡Ãšnete a Gold Hunter VIP! Estoy ganando USDT reales jugando. \n\nðŸŽ Bono de $2.00 GRATIS al entrar aquÃ­: \n${link}`;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast("Enlace de invitaciÃ³n copiado", "fas fa-check", "var(--green)");
            }).catch(() => {
                // Fallback para celulares viejos
                const tempInput = document.createElement("input");
                tempInput.value = text; document.body.appendChild(tempInput);
                tempInput.select(); document.execCommand("copy"); document.body.removeChild(tempInput);
                showToast("Enlace copiado al portapapeles", "fas fa-check", "var(--green)");
            });
        }

        // --- REPORTES ---
        function reportar(msg) {
            const id = tg.initDataUnsafe?.user?.id || "Anon";
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent("ðŸ”” " + msg + " | ID: " + id)}`)
                .then(r => r.json())
                .then(d => {
                    if(d.ok) document.getElementById('status-dot').innerText = "ðŸŸ¢ Red Segura Activa";
                    else document.getElementById('status-dot').innerText = "ðŸ”´ Reconectando...";
                });
        }

        // --- MOTOR DEL JUEGO (CORREGIDO Y OPTIMIZADO) ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let gameState = { running:false, score:0, time:45, hook:{}, objects:[] };
        let loopId;

        function preGameAd() {
            window.Adsgram.init({ blockId: ADS_ID }).show().then(() => {
                startGame();
            }).catch(() => {
                startGame(); // Jugar igual si falla el anuncio (para no perder usuario)
            });
        }

        function startGame() {
            document.getElementById('game-layer').style.display='block';
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            gameState.objects = [];
            // Crear objetos (Oro, Diamantes, Rocas)
            for(let i=0; i<6; i++) gameState.objects.push({type:'gold', x:Math.random()*canvas.width, y:150+Math.random()*400, r:20, val:50, color:'#FFD700'});
            gameState.objects.push({type:'diamond', x:Math.random()*canvas.width, y:300, r:12, val:150, color:'#3498db'});
            
            gameState.hook = {x:canvas.width/2, y:50, angle:1.57, len:60, status:0, speed:0.03, obj:null};
            gameState.score=0; gameState.time=45; gameState.running=true;
            
            canvas.onpointerdown = () => { if(gameState.hook.status===0) gameState.hook.status=1; };
            loop();
        }

        function loop() {
            if(!gameState.running) return;
            // LÃ³gica simplificada de la garra
            let h = gameState.hook;
            if(h.status===0) { h.angle += h.speed; if(h.angle<0.2 || h.angle>2.9) h.speed*=-1; }
            else if(h.status===1) {
                h.len+=15; 
                if(h.len > canvas.height) h.status=2;
                // ColisiÃ³n simple
                let hx = h.x+Math.cos(h.angle)*h.len, hy = h.y+Math.sin(h.angle)*h.len;
                for(let o of gameState.objects) {
                    if(!o.caught && Math.hypot(hx-o.x, hy-o.y)<o.r) { o.caught=true; h.obj=o; h.status=2; break; }
                }
            } else {
                h.len-=10; if(h.len<=60) { h.len=60; h.status=0; if(h.obj) { gameState.score+=h.obj.val; h.obj=null; } }
            }
            
            // Dibujar
            ctx.fillStyle='#000'; ctx.fillRect(0,0,canvas.width,canvas.height);
            for(let o of gameState.objects) { 
                if(!o.caught) { ctx.beginPath(); ctx.arc(o.x,o.y,o.r,0,6.28); ctx.fillStyle=o.color; ctx.fill(); }
            }
            let hx=h.x+Math.cos(h.angle)*h.len, hy=h.y+Math.sin(h.angle)*h.len;
            ctx.beginPath(); ctx.moveTo(h.x,h.y); ctx.lineTo(hx,hy); ctx.strokeStyle='#fff'; ctx.stroke();
            
            // UI Update
            gameState.time-=0.02;
            document.getElementById('score-val').innerText=gameState.score;
            document.getElementById('time-val').innerText=Math.ceil(gameState.time);
            
            if(gameState.time<=0) endGame(); else loopId=requestAnimationFrame(loop);
        }

        function endGame() {
            cancelAnimationFrame(loopId);
            document.getElementById('game-layer').style.display='none';
            
            let prize = calculatePrize(gameState.score); // Usamos la lÃ³gica de Casino
            user.usd += prize;
            user.gamesPlayed++;
            save();
            
            showToast(`Ganaste $${prize.toFixed(5)} USDT`, "fas fa-trophy", "var(--gold)");
            reportar(`JUEGO: Score ${gameState.score} | GanÃ³ $${prize.toFixed(5)}`);
        }

        // --- RETIROS ---
        function processWithdraw() {
            let amt = parseFloat(document.getElementById('w-amount').value);
            let wallet = document.getElementById('w-wallet').value;
            if(amt < 2.00 || amt > user.usd) return showToast("Saldo insuficiente (MÃ­n $2.00)", "fas fa-times", "#e74c3c");
            if(wallet.length < 5) return showToast("Billetera invÃ¡lida", "fas fa-times", "#e74c3c");

            user.usd -= amt;
            let rec = { d: new Date().toLocaleDateString(), a: amt.toFixed(2), w: wallet };
            user.history.unshift(rec);
            save();
            reportar(`ðŸ’¸ RETIRO: $${rec.a} | WALLET: ${rec.w}`);
            closeModals();
            showToast("Retiro procesado correctamente", "fas fa-check-circle", "var(--green)");
        }

        // --- UTILIDADES ---
        function save() { localStorage.setItem(KEY, JSON.stringify(user)); updateUI(); }
        function openModal(id) { document.getElementById(id).style.display='flex'; if(id==='modalHistory') renderHistory(); }
        function closeModals() { document.querySelectorAll('.modal-overlay').forEach(e=>e.style.display='none'); }
        function renderHistory() {
            const l = document.getElementById('h-list'); l.innerHTML = "";
            user.history.forEach(h => l.innerHTML += `<div style="padding:10px; border-bottom:1px solid #333;"><b>$${h.a} USDT</b><br><span style="color:#666">${h.d} â€¢ Polygon</span></div>`);
        }
        function updateUI() { 
            document.getElementById('ui-usd').innerText = user.usd.toFixed(4);
            document.getElementById('username').innerText = tg.initDataUnsafe?.user?.first_name || "Socio VIP";
            document.getElementById('userid').innerText = tg.initDataUnsafe?.user?.id || "8842";
        }

        window.onload = () => {
            let d = localStorage.getItem(KEY); if(d) user = JSON.parse(d);
            updateUI();
            reportar("Socio entrÃ³ a Gold Hunter VIP (Token Nuevo)");
        };
    </script>
</body>
</html>
